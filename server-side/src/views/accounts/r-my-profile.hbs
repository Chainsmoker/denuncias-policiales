<!DOCTYPE html>
<html lang="es">

<head>
    {{> head }}
</head>

<body class="bg-body-bg">
    {{> preloader }}
    {{> sidebar }}
    <div class="container-fluid" x-data="profile">
        <div class="main-content d-flex flex-column">
            {{>header}}
            <div class="main-content-container overflow-hidden">
                <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-4 mt-1">
                    <h3 class="mb-0"></h3>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb align-items-center mb-0 lh-1">
                            <li class="breadcrumb-item">
                                <a href="/dashboard" class="d-flex align-items-center text-decoration-none">
                                    <i class="ri-home-8-line fs-15 text-primary me-1"></i>
                                    <span class="text-body fs-14 hover">Dashboard</span>
                                </a>
                            </li>
                            <li class="breadcrumb-item active" aria-current="page">
                                <span class="text-secondary">Perfil</span>
                            </li>
                        </ol>
                    </nav>
                </div>

                <div class="social-profile">
                    <div class="card border-0 bg-white rounded-10 mb-4">
                        <div class="position-relative">
                            <img src="/assets/images/profile-big-cover.jpg" class="rounded-top-3 w-100"
                                alt="profile-cover">
                            <div class="position-absolute z-1" style="bottom: 20px; right: 20px;">
                                <button class="btn btn-primary text-white fs-16 fw-normal hover rounded-1"
                                    style="padding: 14px 26px; display: none">
                                </button>
                            </div>
                        </div>
                        <div class="card border-0 rounded-10 p-20 pb-0 rounded-top-0 profile-info"
                            style="background-color: transparent !important;">
                            <div class="d-flex justify-content-between align-items-end flex-wrap gap-3">
                                <div class="d-flex align-items-end">
                                    <div class="flex-shrink-0 position-relative">
                                        <div class="avatar-upload">
                                            <div class="avatar-preview">
                                                <div id="imagePreview"
                                                    :style="`background-image: url(${data.user.avatar});`">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="flex-grow-1 ms-20 mb-45">
                                        <h3 class="mb-1" x-text="data.user.full_name"></h3>
                                        <span class="fs-16"><a href="javascript:void(0);"
                                                x-text="data.user.email"></a></span>
                                    </div>
                                </div>
                            </div>

                            <ul class="nav nav-tabs profile-tabs border-0 justify-content-center gap-2" id="myTab"
                                role="tablist">
                                <li class="nav-item" role="presentation">
                                    <a href="/dashboard/profile"
                                        class="nav-link rounded-0 fs-16 border-0 p-0 bg-transparent text-body active">Perfil</a>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <a href="/dashboard/profile/settings"
                                        class="nav-link rounded-0 fs-16 border-0 p-0 bg-transparent text-body">Configuración</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-xxl-3 col-xxxl-12">
                        <div class="card bg-white border border-white rounded-10 p-20 mb-4">
                            <h3 class="mb-20">Información</h3>
                            <ul class="p-0 mb-0 list-unstyled last-child-none">
                                <li class="mb-10 fs-16">ID: <span class="text-secondary"
                                        x-text="`#${data.user.id}`"></span></li>
                                <li class="mb-10 fs-16">Nombre Completo: <span class="text-secondary"
                                        x-text="data.user.full_name"></span>
                                </li>
                                <li class="mb-10 fs-16">Correo Electrónico: <span class="text-secondary"><a
                                            :href="`mailto:${data.user.email}`" x-text="data.user.email"></a></span>
                                </li>
                                <li class="mb-10 fs-16">Rol: <span class="text-secondary"
                                        x-text="data.user.is_superuser ? 'Autoridad' : 'Usuario'"></span></li>
                                <li class="mb-10 fs-16">Ubicación: <span class="text-secondary"
                                        x-text="getUserAddress()"></span>
                                </li>
                                <li class="mb-10 fs-16">Fecha de Registro: <span class="text-secondary"
                                        x-text="new Date(data.user.date_joined).toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' })"></span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-xxl-9 col-xxxl-12">
                        <div class="card bg-white rounded-10 border border-white mb-4">
                            <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 p-20">
                                <h3>Mis Denuncias</h3>
                            </div>

                            <div class="default-table-area mx-minus-1 table-all-projects">
                                <div class="table-responsive">
                                    <table class="table align-middle">
                                        <thead>
                                            <tr>
                                                <th scope="col" class="fw-medium">ID</th>
                                                <th scope="col" class="fw-medium">Usuario</th>
                                                <th scope="col" class="fw-medium">Fecha</th>
                                                <th scope="col" class="fw-medium">Tipo</th>
                                                <th scope="col" class="fw-medium">Descripción</th>
                                                <th scope="col" class="fw-medium">Distrito</th>
                                                <th scope="col" class="fw-medium">Estado</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <template x-for="incident in data.recentIncidents" :key="incident.id">
                                                <tr>
                                                    <td class="text-body" x-text="`#${incident.id}`"></td>
                                                    <td class="text-body" x-text="incident.full_name || 'N/A'"></td>
                                                    <td class="text-secondary" x-text="formatDate(incident.created_at)">
                                                    </td>
                                                    <td class="text-body" x-text="getTypeText(incident._type)"></td>
                                                    <td class="text-body">
                                                        <span
                                                            x-text="incident.description.length > 50 ? incident.description.substring(0, 30) + '...' : incident.description"></span>
                                                    </td>
                                                    <td class="text-body" x-text="incident.district"></td>
                                                    <td>
                                                        <span style="width: 110px;text-align: center;"
                                                            :class="`${getStatusBadgeClass(incident.status)} bg-opacity-10 fs-15 fw-normal d-inline-block default-badge`"
                                                            x-text="getStatusText(incident.status)">
                                                        </span>
                                                    </td>
                                                </tr>
                                            </template>
                                            <tr x-show="data.recentIncidents.length === 0">
                                                <td colspan="8" class="text-center text-body py-5">No se encontraron
                                                    denuncias.
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-xxl-12 col-xxxl-12">
                                <div class="card bg-white border border-white rounded-10 p-20 mb-4">
                                    <h3 class="mb-20">Actividad Reciente</h3>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex-grow-1"></div>

            {{>footer}}
        </div>
    </div>
    <script type="module" src="/assets/js/actions/profile.js"></script>
    {{>scripts}}
</body>

</html>